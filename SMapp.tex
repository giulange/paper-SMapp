\documentclass[APA,LATO1COL,doublespace]{WileyNJD-v2}
\usepackage{moreverb}

% Giuliano
\usepackage{graphicx}
%\graphicspath{ {Figures/} }
\graphicspath{ {daMileti/} }
\usepackage{enumitem} % to have (i) bulletts
% to add trackchanges facilities to the manuscript:
%   > http://trackchanges.sourceforge.net
\usepackage[margins]{trackchanges}
\addeditor{GL} 
%  \note[editor]{The note} 
%\annote[editor]{Text to annotate}{The note} 
%   \add[editor]{Text to add} 
%\remove[editor]{Text to remove} 
%\change[editor]{Text to remove}{Text to add}
%====================================================
% to insert annotations in the manuscript:
\newcommand{\toberevised}[1]{\emph{\textcolor{red}{#1}}} % to be deeply revised
\newcommand{\reviewer}[1]{\emph{\textcolor{cyan}{#1}}}   % set by reviewer
\newcommand{\update}[1]{\emph{\textcolor{blue}{#1}}}     % to be updated
\newcommand{\temp}[1]{\emph{\textcolor{gray}{#1}}}       % lexical review
%
% ==== REVIEW ONLY ====
% http://texdoc.net/texmf-dist/doc/latex/endfloat/endfloat.pdf
% tables and figures at the end of document
\usepackage[notablist,figlist,tablesfirst]{endfloat}
% =====================
%
% == COMMENT AFTER EDITOR APPROVAL ABOUT LENGTH OF PAPER ==
%\usepackage{draftwatermark}
%\SetWatermarkText{Ed. approval}
%\SetWatermarkScale{1.0} % size of the watermark
% =========================================================
%
% ==== ADD ORCID REFERENCE ====
% git repo :: https://github.com/diogo-fernan/academicons
%
%    **ATTEMPT #1**
% See link https://tex.stackexchange.com/questions/275578/is-there-a-standard-way-to-include-orcid-in-tex-pdf
%\usepackage{./academicons}
%\newcommand{\myOrcid}[1]{\href{https://orcid.org/#1}{\textcolor[HTML]{A6CE39}{\aiOrcid}}}
%\definecolor{orcidlogocol}{HTML}{A6CE39}
%
%    **ATTEMPT #2**
% https://tex.stackexchange.com/questions/445563/ieeetran-how-to-include-orcid-in-tex-pdf-with-pdflatex
\usepackage{scalerel}
\usepackage{tikz}
\usetikzlibrary{svg.path}
\definecolor{orcidlogocol}{HTML}{A6CE39}
\tikzset{
  orcidlogo/.pic={
    \fill[orcidlogocol] svg{M256,128c0,70.7-57.3,128-128,128C57.3,256,0,198.7,0,128C0,57.3,57.3,0,128,0C198.7,0,256,57.3,256,128z};
    \fill[white] svg{M86.3,186.2H70.9V79.1h15.4v48.4V186.2z}
                 svg{M108.9,79.1h41.6c39.6,0,57,28.3,57,53.6c0,27.5-21.5,53.6-56.8,53.6h-41.8V79.1z M124.3,172.4h24.5c34.9,0,42.9-26.5,42.9-39.7c0-21.5-13.7-39.7-43.7-39.7h-23.7V172.4z}
                 svg{M88.7,56.8c0,5.5-4.5,10.1-10.1,10.1c-5.6,0-10.1-4.6-10.1-10.1c0-5.6,4.5-10.1,10.1-10.1C84.2,46.7,88.7,51.3,88.7,56.8z};
  }
}
\newcommand\orcidicon[1]{\href{https://orcid.org/#1}{\mbox{\scalerel*{
\begin{tikzpicture}[yscale=-1,transform shape]
\pic{orcidlogo};
\end{tikzpicture}
}{|}}}}
\usepackage{hyperref} %<--- Load after everything else
% =============================
%
%\usepackage{array}
%\usepackage{cleveref}
%\usepackage{siunitx}

\newcommand\BibTeX{{\rmfamily B\kern-.05em \textsc{i\kern-.025em b}\kern-.08em
T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\articletype{Research Article}%

\received{<day> <Month>, <year>}
\revised{<day> <Month>, <year>}
\accepted{<day> <Month>, <year>}

%\raggedbottom

\begin{document}

\title{Soil Monitor: an internet platform to challenge soil sealing in Italy}

\author[1,2]{Giuliano Langella*}
\author[2,3]{Angelo Basile}
\author[4]{Simone Giannecchini}
\author[5,6]{Francesco Domenico Moccia}
\author[1]{Florindo Antonio Mileti}
\author[7]{Michele Munaf\'o}
\author[8]{Francesco Pinto}
\author[1,2]{Fabio Terribile}
\authormark{LANGELLA \textsc{et al}}

%\address[1]{\orgdiv{Org Division}, \orgname{Org name}, \orgaddress{\state{State name}, \country{Country name}}}
\address[1]{\orgdiv{Department of Agriculture}, \orgname{Universit\'a di Napoli Federico II}, \orgaddress{via Universit\'a 100, Portici 80055, \state{Napoli}, \country{Italy}}}

\address[2]{\orgdiv{Interdepartmental Centre on Earth Critical Zone (CRISP)}, \orgname{Universit\'a di Napoli Federico II}, \orgaddress{via Universit\'a 100, Portici 80055, \state{Napoli}, \country{Italy}}}

\address[3]{\orgdiv{ISAFom Institute}, \orgname{National Research Council}, \orgaddress{via Patacca 85, Ercolano 80056, \state{Napoli}, \country{Italy}}}

\address[4]{\orgname{GeoSolutions S.A.S.}, \orgaddress{via di Montramito 3/A, Massarosa 55054, \state{Lucca}, \country{Italy}}}

\address[5]{\orgdiv{Department of Architecture}, \orgname{Universit\'a di Napoli Federico II}, \orgaddress{via Toledo 402, Napoli 80134, \state{Napoli}, \country{Italy}}}

\address[6]{\orgname{Istituto Nazionale di Urbanistica (INU)}, \orgaddress{Via Castro dei Volsci 14, Roma 00179 \state{Roma}, \country{Italy}}}

\address[7]{\orgname{Istituto Superiore per la Protezione e la Ricerca Ambientale (ISPRA)}, \orgaddress{Via Brancati 48, Roma 00144 \state{Roma}, \country{Italy}}}

\address[8]{\orgname{EMM S.R.L.}, \orgaddress{via Vicinale Santa Maria del Pianto, Napoli 80143 \state{Napoli}, \country{Italy}}}


\corres{*Giuliano Langella, Department of Agriculture, Universit\'a di Napoli Federico II. \email{glangella@unina.it}}

\presentaddress{via Universit\'a 100, 80055 Portici, Italy}


\abstract[ Abstract ]{
This work propose a new type of web-based geospatial Decision Support System --- Soil Monitor application (www.soilmonitor.it), developed on top of open-source Geospatial Cyber-Infrastructures (GCI) --- which provides a multidisciplinary operational tool useful for a multi- stakeholder community to challenge soil sealing.
Different technological and technical features of Soil Monitor are presented and discussed with particular reference to the combination of WebGIS with on-the-fly geospatial processing based on GPU computing, specifically designed, developed, and embedded in the presented GCI allowing real-time requests.
In addition, we present three different studies about soil sealing at different scales (national, province and municipality).
Examples of soil sealing indicators are presented, such as an interactive Land Use and Land Cover (LULC) change matrix and the map of rural fragmentation.
The study at national level in the period 1954-2012 illustrated that the type of land use strongly affected soil sealing dynamics.
Indeed, in terms of transformations towards sealed soils, the class \textit{complex cultivation pattern} resulted the most fragile land use while \textit{forests} resulted the most resilient land use.% to the impact of soil sealing.
The study at province level illustrated the key importance of having on-the-fly the map of rural fragmentation for any Italian province.
This map --- quantifying the integrity of the rural territory at each geospatial location --- enables to better locate both new green corridors or new urban developments lowering the impact over the rural environment.
The study at municipality level --- performed over the province of Napoli --- demonstrated the importance of quantifying a pool of spatial planning indicators towards a better landscape planning.
Indeed, it clearly illustrated that (i) the largest urban dispersion occurs in hilly touristic municipalities close to the sea, (ii) the use of the pool of indicators enable to highlight rural sites where the increase in soil sealing is not justified by population growth.
As a result, Soil Monitor is deemed useful both to support decision making at different spatial scales (from national to municipality level) and to raise awareness in people, professionals, and experts of other fields.

% === OLD ===
%\reviewer{["no quantitative result" $\Longrightarrow$ we can claim both "qualitative" and "quantitative" results]}
%This work propose
%aims \toberevised{to show \reviewer{[avoid of "show" / "demonstration"]}} that 
%a new type of web-based geospatial Decision Support System --- Soil Monitor application (SMapp, www.soilmonitor.it), developed on top of open-source Geospatial Cyber-Infrastructures (GCI) --- which provides a multidisciplinary operational tool useful for a multi-stakeholder community to challenge soil sealing.
%Different technological and technical features of SMapp are presented and discussed with particular reference to the combination of WebGIS with on-the-fly geospatial processing based on GPU computing, specifically designed, developed, and embedded in the presented GCI allowing real-time requests.
%Soil Monitor is shown as operational in three different case studies, which are also different scales where policy making and decisions about measures to tackle land take are entangled, at least in Italy.
%Accordingly, examples of soil sealing indicators are presented, such as an interactive Land Use and Land Cover (LULC) matrix and the map of rural fragmentation.
%\reviewer{("no quantative results": PUT HERE A SUMMARY)}
%As a result, SMapp models are deemed useful to 
%(i) support decision making, 
%(ii) raise awareness in people, professionals, and experts of other fields, 
%and (iii) contrastingly put current law in force and actual land take situation owing to multitemporal datasets as an ex post control tool.
%The pros and cons are discussed with special emphasis on the limits (new codes from scratch) and benefits (low-cost, low-energy fast computing) from the use of codes and primitives for land degradation written in CUDA (Compute Unified Device Architecture): a library to maintain and develop further in order to success in facing land take, according to the zero land take deadlines.
}

\keywords{soil sealing, geospatial decision support system, CUDA, GPU computing, urban planning}
%Class file; \LaTeXe; \emph{Wiley NJD}}

\jnlcitation{
\cname{%
    \author{Langella G.}, 
    \author{A. Basile}, 
    \author{S. Giannecchini}, 
    \author{F.D. Moccia}, 
    \author{F.A. Mileti},
    \author{M. Munaf\'o},
    \author{F. Pinto} and
    \author{F. Terribile}
}
(\cyear{<year>}), 
\ctitle{Soil Monitor: an internet platform to challenge soil sealing in Italy},
\cjournal{Land Degradation \& Development}, \cvol{<year>;<number>:<page>--<page>}.}

\maketitle

%\footnotetext{\textbf{Abbreviations:} ANA, anti-nuclear antibodies; APC, antigen-presenting cells; IRF, interferon regulatory factor}

\section{Introduction}\label{sec1}
Soil sealing refers to covering the ground by an impermeable material and is both the most serious land degradation process in Europe and one of the most important form of land degradation worldwide \citep{FAO15}.
It is regarded as one of the most serious threat to soil functions since it strongly disturbs or removes essential ecosystem services (e.g. \citealp{Calzolari16,Dunbar13}.
Moreover, the European Environmental Agency \citep{EEA2011} highlights that land take (land converted into artificial surfaces) by cities has increased by about 80\% in the past 60 years whereas population has grown by only 33\%.
% == OLD ==
%Soil sealing is one of the most serious land degradation processes, which refers to covering the ground by an impermeable material.
%It is regarded as the greatest threat to soil functions since it strongly disturbs or removes essential ecosystem services such as food production, \toberevised{water absorption, rainwater infiltration, and groundwater recharge}, filtering and buffering capacity of the soil, biodiversity, etc. \citep{FAO15}.
%Accordingly, several services of such kind are \toberevised{irreplaceable}, such as those provided and supported by healthy soils and diverse vegetation \citep{Dunbar13}.
%According to the European Environmental Agency \citep{EEA2011}, land take (land converted into artificial surfaces) by cities has increased by about 80\% in the past 60 years (whereas population has grown by only 33\%); thus, soil sealing and land take are the most important issues reducing irreplaceable ecosystem services.
% == OLD ==

Several European policy documents have been produced to tackle the loss of ecosystem services as well as the restoration and maintenance thereof, such as the Habitats (92/43/EEC) and Birds (2009/147/EC) Directives, the Common Agriculture Policy (CAP), and the EU Biodiversity Strategy to 2020 (specifically, Target 2).
In addition to the general regulatory frameworks, important policy measures specifically dealing with ecosystem services provided by soil functions include the Thematic Strategy for Soil Protection \citep{EC2006} and implementation of the Strategy \citep{EC2012}; the Roadmap to a Resource Efficient Europe \citep{EC2011a} targeted to limit the yearly land take at the EU level by 2020 and aiming to achieve the zero net land take by 2050 in line with the RIO conference in 2012; the delivery of guidelines of good practices to mitigate soil sealing \citep{SWD12}; the delivery of the United Nations agenda \citep{UN15} for sustainable development goals, specifically Goal 11 ''\textit{Make cities and human settlements inclusive, safe, resilient, and sustainable}'' \citep{Keesstra16}.
Despite the large list of regulatory frameworks, there are no signs of change at present, and soil sealing continues to increase annually \citep{FAO15} at global (e.g. Secretariat of the Convention on Biological Diversity, 2012; UN, 2014), European (e.g. \citealp{SWD12}), and national scales \citep[e.g.][Copernicus Land Monitoring Service\footnote{ http://land.copernicus.eu}]{ISPRA16,ISPRA18}.
Moreover, the causes for soil sealing are very diverse and possible actions strongly depend on where they should be taken.

In the last decade, research on soil sealing has attempted to contribute to the understanding of this challenging soil degradation process. Major effort has been undertaken for the development of suitable monitoring methodologies \citep{ISPRA18,Alvarado18} and the evaluation of the impacts over the loss of soil ecosystem services \citep{Calzolari16}. Differently, limited effort has gone into the research aims of developing operational spatial decision support tools addressing soil sealing.
This situation is unfortunate considering that there is a growing body of applications illustrating the utility of the Spatial Decision Support System (SDSS) and visualization tools for spatial and urban planning  \citep[e.g.][]{Bishop98,Geertman12,Carsjens07,Malczewski04,Malczewski06,Meyer08}.
In most cases, these SDSS have been conceived and developed to address small geographical areas, such as the SDSS proposed by \cite{Piero17} for 13 municipalities in South Italy, or for solving few, if not one, specific problems \citep[e.g.][]{Fedra98,Meyer08,Torresan16}. %(e.g. Fedra \& Feoli, 1998; Meyer \& Grabaum, 2008; Torresan et al., 2016).

Moreover, few contributions have clearly identified that urban planning DSS must include predictive scenario analysis \citep{Choi16,Xiang03,Volk10} and \textit{what-if} modelling. In fact, this is very much required in planning procedures in order to design and evaluate the potential impact of alternative urban/rural spatial plans \citep{Hawkins02,Harms95,Choi16,vonHaaren06}. 
Furthermore, scenario analysis is crucial in Strategic Environmental Assessment (e.g. SEA and EIA EU Directives). Currently, this fundamental planning procedure is dominated by qualitative assessment methods while there is a great demand for objective and quantitative methods \citep{Choi16} to provide more accurate and quantitative predictions of the impact of a plan or project \citep{Carver03,Vanderhaegen05}.

A decision support system addressing soil sealing should rely on well-established models, algorithms, and indicators. The use of indicators to monitor and assess soil sealing is already well known \citep{King16}, and there has been a proliferation of indicators, metrics, reports, community indicators, state of the art reports, assessment reports, etc. \citep{Maclaren96,Tanguay10}.
In addition, specific spatial resolution requirements of indicators have been greatly emphasised \citep{Jaeger08}.
Furthermore, a large set of soil sealing indicators is typically tuned to the specific geographic, environmental, and socio-economic setting under investigation.
For instance, \citet{Munafo13}, analysed the Italian territory and identified soil sealing trends in relation to the distance from the coastline or the elevation belt, to the land cover classes or the distance from neighbour urban patches.
Accordingly, references to soil sealing indicators and best practices regarding producing them in different EU countries have been reported in \citep{EC2011b} in which, for instance, the monitoring of built areas, the total amount of green areas within city boundaries, and the unpaved land areas can be found.
Definitely, despite a large body of researches dealing with this complex issue has been already produced, some steps forward must been done in order to handle laws and regulations requirements for tackling soil sealing.

% AIMS PARAGRAPH: topic sentence (gap) -> supporting sentences (needs) -> concluding sentence (our work)
Therefore, authors stress on the current
%there exist a gap between land degradation and soil sealing issues and tools coming from research that can help stakeholders tackle these issues.
strong gap in developing and providing integrated operational tools 
dealing with soil sealing 
to support quantitative analysis, awareness building and decision making by stakeholders.
This gap is amplified by a complete lack of tools 
%dealing with soil sealing 
capable to analyze large areas, and the situation is even more difficult, considering that these tools --- to be properly operated by planners --- should also enable scenario analysis (the so called \textit{what-if} modelling).
In more detail, it is thoroughly evident that 
(i) action is required since ``future generations will not see a healthy soil coming back within their lifetime once it has been destroyed\dots'' \citep{SWD12}; 
(ii) soil sealing mitigation must embody urban and landscape planning tools \citep{Artmann14}, enabling the link of opposite socio-economic driving forces, such as urban regeneration versus environmental protection; 
(iii) inter- and trans-disciplinary studies integrating soils in the environment are required to challenge soil sealing;
(iv) a cross-topic awareness should be raised regarding soil sealing in the policy, research, and public sectors.
A viable solution to fill this gap fits with the general aim of our work, which deals with the development of
%This paper presents
%(\toberevised{demonstrate}\reviewer{[avoid of "demonstration" and add a "clear research purpose"]} that)
a new type of geospatial DSS --- a web-based DSS, namely Soil Monitor application (SMapp) --- developed on top of Geospatial Cyber-Infrastructures (GCI), providing a multidisciplinary operational tool useful for a multi-stakeholder community to challenge soil sealing at different spatial scales.

%This system is designed to address the accountancy of soil sealing through different indicators providing operational support to urban planners, decision makers and multi stakeholders involved in landscape planning and interested in evaluating the impact of soil sealing. 
%This specific contribution required a different approach, the result of which is the Soil Monitor web application. 
%A set of indicators can be calculated in real-time using either Italian administrative levels (NUTS2, NUTS3, and LAU2) or user-drawn Regions of Interest (RoI). 
%Moreover, Soil Monitor uses high resolution layers produced every year by ISPRA (Italian Institute for Environmental Protection and Research) since 2015 for drawing up the yearly soil sealing report in Italy. 
%Thus, owing to the high-performance computing embedded in its cyber infrastructure, Soil Monitor enables real-time geospatial processing while preserving a high spatial detail of the analysis over large areas (till LAU2); this combination of features has an intrinsic vast potential for being used in operational spatial planning. 

%\section{ \change[GL]{Soil Monitor application (SMapp)} { Materials and Methods } }
\section{Materials and methods} \label{sec:MatMet}
%\subsection{System architecture}
%\subsection{ Development of Soil Monitor }
%Soil Monitor\footnote{\emph{www.soilmonitor.it}} is currently in use and active within the Italian administrative boundaries (Figure \ref{fig:SMapp}).
Soil Monitor is a decision support system which enables users to interact directly with the geospatial data on the map via the web (Figure \ref{fig:SMapp}).
%The Soil Monitor application (SMapp) 
It is built on free and open-source geospatial libraries and programs specifically designed to create, manage, and share different types of geospatial information in a rather safe, simple, and intuitive way.
In particular, it is deployed on the dual infrastructure GeoServer and MapStore, the both of which are mainly developed and maintained worldwide by GeoSolutions.

\begin{figure}[t] % FIGURE 01
    % \includegraphics[width,,height=15pc,draft]
    \centerline{\includegraphics[width=500pt]{daMileti/01_piattaforma.pdf}}
    \caption{Exemplification of the Soil Monitor dashboard with main panes (red boxes). 
    The user can build a tailored query owing to the job submission steps thanks to two distinct accordion panes, one designed for the LULC change toolbox (a) and another one dedicated to the soil sealing toolbox (b). 
    Geospatial calculations can be distributed on GPU cards owing to a tailored CUDA-C library developed for Soil Monitor (c). } \label{fig:SMapp}
\end{figure}

Soil Monitor is based on a three-tier logical architecture (Figure\ref{fig:GCI}) with separated processes made by 
(i) 
the \textit{data tier} (section \ref{sec:dataTier}), which consists of the database where information is stored and retrieved in a manner that keeps data neutral and independent of the application servers and of the logic tier,
(ii) the \textit{visualization tier} (section \ref{sec:viewTier}), which displays information related to the data and services
and 
(iii) 
the \textit{logic tier} that controls the functionality of the application by performing detailed geospatial processing (section \ref{sec:logicTier}).

\begin{figure}[t] % FIGURE 02
    % \includegraphics[width,,height=15pc,draft]
    % trim=left bottom right top, trim=0 0 0 50,clip,
    \centerline{\includegraphics[width=500pt]{daMileti/02_infrastruttura.pdf}}
    \caption{Main tiers, workflows, and technological components of the SMapp geospatial cyber infrastructure.
    The operating mode of the platform is sketched showing the flow of data that feeds different server functions (e.g. models), which, in turn, produces a set of services that can be finally accessed by the dashboard.
    } \label{fig:GCI}
\end{figure}

%The data and visualization tiers are described in section \ref{sec:dataTier} and section \ref{sec:viewTier} respectively, while a summary of the logic tier is in section \ref{sec:logicTier}.


\subsection{Data (data tier) }
%\update{[materials]}}
\label{sec:dataTier}
The Open Geospatial Consortium (OGC), which aims to develop community-consensus open geospatial standards, provides a family of enabling technologies for sharing geospatial data and analytical capabilities on a distributed network. 
Data sharing (interoperability) in Soil Monitor is supported both in input --- to visualize data coming from remote services (e.g. those provided by ISPRA or other national level administrative bodies) --- and in output to provide different data services such as WMS (Web Mapping Service, for serving georeferenced map images over the internet) and WFS (Web Feature Service, which supports the vector data model). % to allow a client visualization of output images produced by the logic tier.
These web services are automatically appended to the output images produced by the logic tier %new geospatial data %calculated by the CUDA engine 
to enable the visualization of results both locally within Soil Monitor, and remotely, for instance, within desktop GIS software environments.
Indeed, after ingestion in GeoServer, data become available for visualization and calculation purposes for the whole Italian territory Soil Monitor stores as follows:
\begin{itemize}
    \item The land use and land cover map in the period of 1956-60 produced by the Italian Touring Club in collaboration with National Council of Research, CNR (map of land use in Italy, scale 1: 200.000).
    \item The CORINE Land Cover (CLC) is a valuable source of information about land use and land cover, produced at the European level since the '90s and updated regularly (originally coordinated by the European Commission and the European Environmental Agency; now included in the Copernicus framework).
    CLC vector data are produced by photointerpretation of satellite images, with a minimum mapping unit of 25 ha and a classification system organized in three hierarchical levels of thematic detail: level 1 with 5 land use and land cover classes, level 2 with 15 land use and land cover classes, and level 3 with 43 land use and land cover classes. 
    In SMapp, the raster version of CLC with a spatial resolution of 100 m is available for the years 1990, 2000, 2006, 2012, and 2018. Considering the homogeneity over the entire Europe and the constant update, CLC is largely used for spatial analysis, land cover change assessment, and policy making.
    \item The National High-Resolution Soil Consumption (NHRSC) was produced for Italy by ISPRA (ISPRA, 2016); the NHRSC is a raster that identifies artificial land cover areas with a spatial resolution of 10 m, produced for 2006, 2009, 2012, 2015, 2016, 2017 and 2018 with a semi-automatic classification of satellite images and the integration of local ancillary data such as OpenStreetMap; NHRSC included in Soil Monitor has a binary classification system such as non-sealed soil and sealed soil, according to the description given in Table \ref{tab:IMPclasses}.
    \item The administrative units: Italian administrative data are provided by the Italian institute of statistics (ISTAT). 
    These data represent the administrative units (also NUTS) in vector format.
    \item The population: population data are provided at the Municipal level by ISTAT, which periodically collects census data and updates this information every year. 
    \item The digital soil grids: Predictions on key soil properties performed globally at 250 m spatial resolution by ISRIC\footnote{available at http://data.isric.org/geoserver/sg250m/wms}. This is an example of OGC compliant interoperability based on WMS which is used as input source of georederenced map images in SMapp.
\end{itemize}

\begin{table}
\caption{Legend of the NHRSC map}\label{tab:IMPclasses}
\centering
\begin{tabular}[t]{ l l | l } 
\hline
\textbf{Code} & \textbf{Description} & \textbf{Classes} \\
\hline
\multirow{9}{4em}{0} & \multirow{9}{10em}{Non-sealed soil} & Tree/shrubs \\ 
 &  & Crops \\ 
 &  & Grassland \\ 
 &  & Water bodies \\ 
 &  & Wetlands \\ 
 &  & Rocks, beaches, and dunes \\ 
 &  & Glaciers and perpetual snow \\ 
 &  & Sport areas (pervious surface) \\ 
 &  & Other pervious surfaces \\ 
\hline
\multirow{10}{4em}{1} & \multirow{10}{10em}{Sealed soil} & Buildings \\ 
 &  & Road/Squares/Parking \\ 
 &  & Railway sites \\ 
 &  & Airports and ports (impervious surfaces) \\ 
 &  & Impermeable areas in sports fields \\ 
 &  & Permanent greenhouses \\ 
 &  & Solar farms on land \\ 
 &  & Mining areas \\ 
 &  & Dump sites \\ 
 &  & Other impervious areas \\
\hline
2 & Unclassified & \\
\hline
3 & Area outside the national boundary & \\
\hline
\end{tabular}
\end{table}

The CLC and Touring layers have been rasterized into images at 8-bit and 100 meters resolution to enable the grid-based calculations. % based on the CUDA framework.
Comparisons between CLC layers can be executed at three different levels of the legend detail (Level 1, Level 2, and Level 3) having different numbers of land use and land cover classes. 
In order to enable comparisons with the Italian Touring Club layer, the most detailed CORINE legend (Level 3) has been homogenized with that from Touring Club. 
The imperviousness layers have been binarized (2-bit images) by applying a threshold to the level of imperviousness equal to 30\% of the pixel area, above which a pixel is taken as impervious.

\subsection{Development of the dashboard (visualization tier) }
%\update{[methods]}}
\label{sec:viewTier}
% Visualization of data and use of soil sealing tools
The dashboard design includes graphical tools, procedures to combine spatial data (analysis and visualization), and the production of tables and maps. 
The frontend application is based on MapStore (Figure \ref{fig:GCI}) and the overall structure of the graphical user interface can be distinguished in four main panes: the data, the map, the workspace, and the analysis panes (Figure \ref{fig:SMapp}).
The \textit{data pane} enables the visualization of different data, but not all information used in the calculation is visible, such as the population vector data. 
Moreover, MapStore enables users to add external data sources equipped with web services for rendering rasters and vectors, enhancing the overall interoperability of the platform. 
For instance, it can be particularly useful to compare the result of calculations with constraint maps coming from other data providers, such as the Italian Ministry of Cultural and Environmental Heritage, to check the soil sealing results. Furthermore, the \textit{map pane} enables the visualization of both the input geospatial data and the output maps calculated by the models and indicators available in the toolboxes. 
Moreover, the \textit{workspace pane} is where all instantiated requests are displayed. 
The toolboxes enable the allocation of several asynchronous requests per single user at the same time, which means that they can be calculated concurrently on the available CPU and GPU resources. 
The processes launched by users, which may be running at the same time, are displayed in the workspace as running, completed or interrupted according to their states. 
The \textit{analysis pane} is made by two \textit{accordion panes} that are used to give the user full access to the logic tier parameters in a transparent way (see Figure \ref{fig:SMapp} for the query building procedure).

In addition to standard open-source codes available from the dual infrastructure GeoServer and MapStore, new codes have been written to enrich the functionality of Soil Monitor. 
For example, the client side has a dedicated interface to build the RoI, which includes different methods such as the multiple selection of several administrative units at any hierarchical level (municipalities, provinces, and regions) or the automatic selection of all the administrative units at the hierarchical level below the one selected (e.g. all the municipalities belonging to a province). 
Another example of custom codes included in GeoServer and MapStore is given by the availability of different types of Highcharts plots that are generated dynamically in addition to the visualization of map images, in order to enhance the readiness and interpretation of results.


\subsection{Soil sealing metrics embedded in Soil Monitor } %\update{[methods]}}
\label{sec:metrics}
% https://smurbs.eu/wp-content/uploads/2018/10/ISPRA_Metrics.pdf
% https://ec.europa.eu/environment/archives/soil/pdf/sealing/Soil%20Sealing%20In-depth%20Report%20March%20version_final.pdf
% URBAN GROWTH MONITORING, METRICS, URBAN GROWTH, URBAN DENSITY AND SPRAWL, GREEN AREAS, SOIL SEALING RATIOS
Huge amount of metrics is available to monitor and measure urban growth, urban density and sprawl, soil sealing and land take.
The limited list of indicators developed and implemented in Soil Monitor have been chosen in close collaboration with italian urban planners to address their specific needs while avoiding redundancy of information often given by similar metrics. 
A summary of available metrics is given in Table \ref{tab:SMappToolbox}.
They include land use and land cover metrics, rate of change of land use and land cover, marginal soil sealing, extent of urban sprawl, density of urban boundaries, degree of urban dispersion, rural and urban fragmentation, land take dynamics, and estimate of loss in food supply due to land take. 

The metrics shown in Table \ref{tab:SMappToolbox} can use as input one of the two official datasets described in the data tier section above, that is the Corine Land Cover and the soil imperviousness. 
The CLC layers allow investigations on multiple classes of land use and land cover but at a relatively coarser spatial resolution (either 100 m or 250 m spatial resolution without or with the Touring Club data respectively).
Conversely, soil imperviousness is available over high spatial detailed layers (20 m spatial resolution) but aggregates the information of land use in only two classes, that is sealed and unsealed land as defined in Table \ref{tab:IMPclasses}. 
Finally, the choice between the two datasets reflects the kind of soil sealing metric, the detail in the thematic domain, and the spatial resolution required in the output map.

\begin{table}[b]
    \caption{ Models in SMapp toolbox for soil sealing and land take. }
    \label{tab:SMappToolbox}
    \small
    \centering
    \begin{tabular}{m{0.3cm} p{0.1cm} p{1.2cm} p{3.5cm} *{3}{p{2.7cm}} p{1.0cm} }
    
    \toprule
        & \textbf{ID} & \textbf{Model} & \textbf{Formula$^\dagger$} & \textbf{Description} & \textbf{Application} & \textbf{Techonological Novelty} & \textbf{Outputs}\\
    \midrule\midrule
    
    \multirow{5}{*}{ \rotatebox[origin=c]{90}{ \shortstack[c]{ Calculation using LULC rasters at 100m spatial resolution \\ (e.g. CLC produced by Copernicus)} } } 
    & 0 & LULC & --- & Change of state of each LULC class from a reference year to a current year & Evolutionary trajectories & CUDA kernels producing both an interactive change matrix and a map of all changes & pie chart, raster map  \\
    
    & 1	& Coverage Coefficient & $\frac{S_{CLC_i}}{S_{AU}}$ & Fraction of total surface covered by i-th land use/cover class & Classes consistency within a user defined RoI (admin unit or free area) & None & bar chart, vector map \\
        
    & 2 & Rate of Change & 
    $\frac{ \left(S_{CLC_i}\right)_{T_2} - \left(S_{CLC_i}\right)_{T_1} }{ \left(S_{CLC_i}\right)_{T_1} }$ 
    & Rate of change of any i-th land use/cover class & Change of classes consistency within a user defined RoI (admin unit or free area) & None & bar chart, vector map \\
    
    & 3 & Marginal Land Take & 
    $\frac{ \left(S_{CLC_1}\right)_{T_2} - \left(S_{CLC_1}\right)_{T_1} }{ \left(POP_{au}\right)_{T_2} - \left(POP_{au}\right)_{T_1} }$
    & Ratio between urbanization variation and population growth variation between two years & Analyse variation of urbanization with respect to variation of population to depict temporal trends & None & bar chart, vector map \\
    
    & 4	& Urban Sprawl & 
    $\frac{ \frac{ \left(S_{CLC_1}\right)_{T_2} - \left(S_{CLC_1}\right)_{T_1} }{ \left(S_{CLC_1}\right)_{T_1} }  }     { \frac{ \left(POP_{au}\right)_{T_2} - \left(POP_{au}\right)_{T_1} }{ \left(POP_{au}\right)_{T_1} } }$
    & Ratio between urbanization rate and population growth rate between two years & Standardized version of marginal land take & None & bar chart, vector map \\
    
    \midrule
    
    \multirow{9}{*}{ \rotatebox[origin=c]{90}{ \shortstack[c]{Calculation using high resolution imperviousness rasters at 20m spatial resolution \\ (NHRSC produced by ISPRA)} } } 
    & 5 & Urban sprawl & 
    $\frac{S_{DUF}}{S_{UT}}$ 
    & Ratio between discontinuous urban fabric and total urban surface & To know the composition of urban development related to sprawl phenomenon, which can be related to fragmentation & Tailored connected component labelling algorithm in CUDA & bar chart \\
    
    & 6 & Edge Density (ED) &
    $\frac{P_{UT}}{S_{UT}}$ 
    & Ratio between perimeter and surface of urbanized ares in selected RoI & Density of urban margins, which is related to urban fragmentation & CUDA kernels computing both the perimeter and the urbanized area & bar chart \\
    
    & 7 & Urban Area &
    $\frac{S_{UT}}{S_{AU}}$ 
    & Fraction of total surface covered by urbanization & To know the magnitude of land take related to the administrative unit & CUDA kernels computing the urbanized area	& bar chart \\
    
    & 8	& Largest Class Patch Index (LCPI) & 
    $\frac{S_{max}}{S_{UT}}$ 
    & Fraction of urban surface within the largest urban patch & Represents the level of compactness of the urban area & CUDA kernels computing the connected component labelling	& bar chart \\
    
    & 9	& Residual Mean Patch Surface (RMPS) &
    $\frac{S_{DUF}}{N_{DUF}}$ 
    & Average surface of all urban patches excluding the largest patch & Mean patch area within the discontinuous urban fabric, which can be related to urban texture & CUDA kernels computing the connected component labelling & bar chart \\
    
    & 10 & Rural/Urban Fragmentation &
    $\frac{\sum^{N}_{k=1} V_k}{ N-1 }$ 
    & Fraction of pixels having the same value of the centre pixel in a mask & e.g. on rural centre pixels it highlights ecological corridors & 1k lines of code; 6 CUDA kernels; 8 geospatial parameters & raster map \\
    
    & 11 & Land Take (and Gains) &
    $ \left( V_{pix} \right)_{T_2} - \left( V_{pix} \right)_{T_1}$ 
    & Difference of the value of a pixel between two different times & A map with three possible pixel values: (0) if no change occurred; (-1) if land take; (+1) if land gain & Based on the basic reduce CUDA kernel & raster map, bar chart \\
    
    & 12 & Net Loss of Food Supply &
    $ \sum_{pix=0}^{image} \left( \left( V_{pix} \right)_{T_2} - \left( V_{pix} \right)_{T_1} \right) \times C $ 
    & --- & Potential loss of aggregated ecosystem function (coeff :: FAO) & Based on the basic reduce CUDA kernel & bar chart \\
    
    & 13 & Model of Urban Development & Composite of IDs 6, 8 and 9 & --- & ---	& Same as aggregating IDs 6, 8 and 9 plus a 3-D view highlighting urban development in both different administrative units and times & 3-D scatter plot \\
    
    \midrule\bottomrule
    
    \multicolumn{8}{p{17.2cm}} % 13.9cm is the sum of all column previously defined by p{}
    {
      \footnotesize{$^\dagger$Definitions. 
      $S$:area;
      $P$:perimeter;
      $V$:value;
      $S_{CLC_i}$:area of $i_{th}$ CORINE Land Cover class at selected legend level; 
      $S_{AU}$: area of administrative unit; 
      $S_{CLC_1}$: area of urban CLC class at selected legend level; 
      AU: administrative unit (city, province, region, \ldots); 
      $T_1$: time before; 
      $T_2$: time after; 
      $POP_{AU}$: population within AU; 
      $S_{DUF}$: area of discontinuous urban fabric; 
      $N_{DUF}$: number of urban patches within discontinuous urban fabric; 
      $S_{UT}$: total urban area; 
      $V_k$: amount of fragmentation of the target pixel \textit{k} within the moving window of N pixels };
      $V_{pix}$:value of pixel in NHRSC raster;
      C: FAO coefficient equal to 0.6 $persons \times ha^{-1} \times year^{-1}$
      .
    }
    \end{tabular}
\end{table}

\subsubsection{ Soil sealing metrics operational: the fast geoprocessing engine (logic tier) } % \update{[methods]} }
\label{sec:logicTier}
%\update{We need a description of the logic tier avoiding it being viewed as a technical report/manual}\\
On the server side, specific functions written in Java (classes) and CUDA (kernels) have been developed to perform the calculations required by the metrics reported in Table \ref{tab:SMappToolbox}. 
Some calculations may be very demanding since they rely on high resolution grids (i.e. a square pixel of size 20 m) or on high thematic detail (i.e. CORINE land cover at level 3 with 43 classes) feeding requests over large geographical areas (such as administrative regions or the whole Italy).
%For instance, this is the case of the rural fragmentation index, which is computed on 20 m imperviousness layers and even relies on an intrinsic demanding geospatial processing. 
%Indeed, even if selecting a small RoI, the relatively high calculation demand depends on the logic of the algorithm itself, since it has to visit about six thousand neighbour pixels $\left( \sim \left( \left(800/20\right)\times2 \right)^2 \right)$ to calculate how fragmented each target pixel is, given a radius of 800 meters in the moving window selected by the user.
These cases may not manage to return answers in real-time or near-real-time
%for relatively large geographical extents
, which explains why 
(i) calculations are instantiated asynchronously in the geospatial cyberinfrastructure, and
(ii) metrics are implemented in GPU computing using the CUDA framework by NVIDIA.
The asynchronous instantiation of calculations in the cyberinfrastructure means that a a request can be submitted without waiting for previous ones to be finished.
This allows both the multi-user concurrency and the submission of as many requests as needed by a single user to address own analysis.
The user can close the web page and then navigate back to the Soil Monitor workspace in a future time to find the results ready for visualization and interpretation.

The second characteristic of the geoprocessing engine is the implementation of most of the metrics showed in Table \ref{tab:SMappToolbox} by means of the CUDA C programming language.
%\toberevised{Each soil sealing metric is made of more CUDA kernels, the assemblage of which manage the production of the required output data.}
The CUDA code and its binding from Java is implemented in the logic tier in which %is connected to the data tier and the visualization tier.
%In the logic tier a 
the list of developed CUDA kernels is loaded as a library in the infrastructure.
The development of the fast geoprocessing engine is as follows (Figure \ref{fig:GCI}, see workflow in logic tier).
First, a library of CUDA kernels is written in C and then compiled in PTX. 
%Further, the Parallel Thread Execution (PTX) is a low-level parallel thread execution virtual machine and instruction set architecture, which provides a stable programming model and instruction set for general purpose parallel programming. 
%Moreover, the PTX instructions are optimized for and translated to native target-architecture instructions. 
Second, the most fundamental CUDA kernels work as primitives that are assembled in the JCUDA layer to build the crafted algorithms  addressing the calculation of soil sealing metrics.
%The pipeline to run a metric implemented in the logic tier, starts from MapStore that collects the user parameters, GeoServer receive the parameters and recognize the exact set of processes to run. From Java code (MapStore/Geoserver) the pipeline continues invoking the JCUDA layer in which the calculation of each metric is assembled. Finally, JCUDA performs calls to the CUDA kernels required to calculate a metric. This is the JAVA/JCUDA/CUDA pipeline of Soil Monitor.% which is a novelty in the implementation of spatial decision support systems using WebGIS over the internet.

In addition to data services (section \ref{sec:dataTier}), Soil Monitor implements Web Processing Services (WPS) which expose algorithm of soil sealing metrics outside the web application (Figure \ref{fig:GCI}, logic tier). 
%The WPS inferface was used during the validation of the fast geoprocessing engine (section \ref{sec:validation}).
%This was particularly useful to perform random tests about the goodness and coherence of calculations in different spatial and temporal contexts (see validation of geoprocessing in section \ref{sec:validation}). %, without the tedious infilling of the accordion panes to submit more and more requests. 
WPS allows to invoke a geospatial process with a known set of parameters by means of the supported POST request method (using the XML language) submitted directly to the GeoServer endpoint (JAVA layer).
After the submission of the request either using the Soil Monitor graphical interface or by the POST method, the parameters are passed to the JCUDA layer, which, as a software bridge, invokes the execution of the CUDA kernels compiled in PTX files.
This is recognized as the \textit{forward} high performance computing phase of the geoprocessing engine, which spans from the request submission step to the matrices production in CUDA.
The matrices returned after CUDA calculations are manipulated to become GIS data that are stored in GeoServer.
This is the \textit{backward} geoprocessing phase of the engine, which spans from the production of CUDA matrices to the storage of map images.
Finally, the map images can be visualised over the Soil Monitor web application (see the visualization tier in section \ref{sec:viewTier}).

%\toberevised{
%In summary, the JAVA/JCUDA/CUDA pipeline implemented in Soil Monitor starts (i) from MapStore collecting the user parameters; then (ii) GeoServer receive the parameters, prepare the inputs and recognize the exact set of processes to run; subsequently to the Java layer (MapStore and Geoserver), (iii) the pipeline continues invoking the JCUDA layer in which the calculation of a metric is assembled using CUDA kernels.
%The advantage of this type of orchestration is that new models and indicators that may be added in the Soil Monitor toolboxes can be implemented using the same library of CUDA kernels, while little development and coding is required in addition.
%}

\subsection{Job submission: how to run metrics and perform quantitative analysis}
\label{sec:jobsubmission}
It was required to implement a systematic workflow approach in the cyberinfrastructure in order to integrate the fast geoprocessing engine based on CUDA kernels with both data and open source geospatial components given by GeoServer (backend) and MapStore (frontend). 
The systematic workflow implemented in Soil Monitor is designed around the end user and includes three major consecutive steps: job submission, the query of job status (e.g. running, completed, failed), and the management of results.
The execution of each step requires a close integration of the three software tiers in the cyberinfrastructure, that is a strong connection between the data, visualization and logic tiers. 

Figure \ref{fig:SMapp} shows an overview of the available toolboxes for analysis, i.e. the toolbox for land use/cover (LULC) change (Figure \ref{fig:SMapp}, a) and the toolbox for soil sealing (Figure \ref{fig:SMapp}, b).
The user can build a tailored query owing to a job submission steps, one for each toolbox. 
For any soil sealing indicator, the user must select --- according to the following hierarchical order --- 
the dataset they intend to use (i.e. CORINE land cover or high-resolution imperviousness layer, Figure \ref{fig:SMapp}, b1); 
the time of the analysis (one year or two years, Figure \ref{fig:SMapp}, b2); 
the selection of a soil sealing indicator (Figure \ref{fig:SMapp}, b3); 
optionally, the composition of LULC classes (Figure \ref{fig:SMapp}, b4); 
and finally, the region of interest (Figure \ref{fig:SMapp}, b5). 
To ease the definition of a possible multi-polygon RoI, there is an ad hoc accordion pane for the rapid identification and selection of any Italian administrative unit.
The RoI definition accordion pane is particularly useful because it allows the user to select one or more administrative units at any level of the topological hierarchy (municipality, province, region) and to freely draw a new region of interest directly over the map displayed within the graphical user interface.
For any subsequent query to the first one, the user can change only the parameters strictly required for the new job submission (e.g. change only the indicator used or the time of the analysis) and SMapp will calculate the new indicator given the parameter set just defined. 
This behaviour was expressly required by end users to facilitate the instantiation of more requests for the purpose of scrutinizing the implementation of executed urban plans.
Two job submission examples are provided in the following sections highlighting some technical details about their implementation.

\subsubsection{Calculate the map of rural fragmentation}
%\toberevised{[FROM section \ref{sec:logicTier}]}
\label{sec:mmFragmentation}
The fragmentation metric is computed on binary imperviousness layers with 20 m spatial resolution and Soil Monitor manages both rural and urban fragmentation.
Fragmentation quantifies how much fragmented a target pixel in the center of a moving window is (Table \ref{tab:SMappToolbox}, $ID = 10$).
Besides other filters such as time and RoI, the job submission for fragmentation requires to configure the size of the moving window (e.g. 800 m) and the type of fragmentation (rural or urban).
In the case of rural fragmentation the target is a non-sealed pixel with value 0 (assumed to be not sealed at all or covered by impervious materials on a maximum of 30\% of the total pixel area) and all sealed pixels (with value 1) within the moving window are summed to calculate the $V_k$ of the fragmentation formula reported in Table \ref{tab:SMappToolbox}.
Contrariwise, in urban fragmentation the target pixel has value 1 and not-sealed pixels (with value 0) are counted.
The calculation of fragmentation relies on inherently demanding geospatial processing.
Indeed, even if selecting a small RoI, the relatively high calculation demand depends on the logic of the algorithm itself, since it has to visit about six thousand neighbour pixels $\left( \sim \left( \left(800/20\right)\times2 \right)^2 \right)$ to calculate how fragmented each target pixel is, given a radius of 800 meters in the moving window selected by the user.
%\toberevised{the difference in the neighbourhood composition between a rural pixel and the one for instance on the right is given by two columns of pixels. Indeed, the pixel on the right discard the most left column of the target pixel and instead consider in the neighbourhood the most right column. The recognition to this slight variations in the neighbourhood composition while moving towards nearby target pixels, suggested to separately calculate row-wise and column-wise cumulative sums for the overall image, and then aggregate by comparing}

\subsubsection{ \toberevised{Calculate the discontinuous urban fabric (metric)} }
\label{sec:mmDUF}
%\toberevised{[FROM section \ref{sec:logicTier}]}
%Accordingly, an example of the pyramidal architecture based on the CUDA kernels is presented in Figure \ref{fig:ccl}, describing the calculation of the discontinuous urban fabric surface ($S_{DUF}$) using a connected component labelling algorithm specifically developed for SMapp. 
This algorithm is made of 8 CUDA kernels and one thousand lines of code performing the labelling of a 2-bit high resolution imperviousness layer in a 64-bit layer of ordered labels, one for each distinct urban patch.
Consequently, after identification and labelling, urban patches are sorted and then a threshold (90\%) is applied to extract only patches belonging to the discontinuous urban fabric. 
These patches are summed up to calculate the overall discontinuous urban fabric surface.


\toberevised{add to the figure the LCPI which is the highest bar in the histogram.
even though the MRPS equation (write here equation) is very simple, this is not true for the implementation.
indeed the the input data is the imperviousness binary map with groppoli of pixels equal to zero immersi in a backgroud of pixels with value zero. the CCL algorithm recognizes the urban patches, labels them with unique id and finally calculates the consistency of each urban patch by means of the histogram function.      }

Do not forget to link the DUF to the metrics on Soil Monitor using it, such as urban sprawl, RMPS, others?

\section{Validation of geoprocessing engine}\label{sec:validation} % \update{[here or results?]} } 
%The Soil Monitor geospatial cyber-infrastructure implements via the web both data services (WMS and WFS, visualization tier in Figure \ref{fig:GCI}) to enhance data interoperability and processing services (WPS, logic tier in Figure \ref{fig:GCI}) to expose 
% % the algorithm of a 
%soil sealing metrics outside the web application.
During the implementation of the 
%Soil Monitor 
cyberinfrastructure we carried out a systematic testing procedure by means of web processing services as explained in section \ref{sec:logicTier}.
The WPS inferface was used to test and validate the fast geoprocessing engine because we could run from hundreds to thousands times calculations without the tedious infilling of the accordion panes over the graphical user interface to submit more and more requests.
POST requests are generally submitted from within the Unix terminal but for  validation purpose the requests were submitted from within MatLab scripts. %, which were specifically designed to validate the geoprocessing engine.
To certify each Soil Monitor model, we collected and compared the results returned by the following three independent computing environments:
\begin{itemize}
    \item Running the stand-alone executable (EXE) compiled from the source CUDA-C code (Figure \ref{fig:GCI} logic tier).
    The source high performance computing code written in CUDA-C can be compiled to get either a stand-alone executable (EXE) or the executable file (PTX) embedded in Soil Monitor.
    In this step we run the stand alone executable passing as input the same data and parameters used in the other computing environments.
    This computing environment is used to validates the goodness of the high performance computing algorithm implemented in CUDA-C.
    \item Running the WPS as explained above.
    It is based on the JAVA-JCUDA-CUDA chain which executes the CUDA kernels compiled in the PTX files. This computing environment is crucial to validate together the forward high performance computing step and the backward geoprocessing step embedded in the Soil Monitor geospatial cyberinfrastructure. 
    \item Running a MatLab code which implements the same geospatial processing but with a different algorithm.
\end{itemize}

The validation ends after a comparison of results coming from the three environments to check for both speed performance and accuracy. 
This procedure was used as a standard during the development stage in order to test for inaccuracies in either the CUDA algorithms targeted to geospatial processing or in the deployment of the JAVA/JCUDA/CUDA computing chains in the cyberinfrastructure.
%Further, WPS can be easily adapted to enable the dynamic binding of geospatial processes to aid user needs, such as running a standardized algorithm on own or custom data.

%\section{ \add[GL]{Results} }
\section{ Results and Discussion } % \toberevised{Results} | remove or describe the fragmentation and DUF} }
\label{sec:results}
Soil Monitor\footnote{\emph{www.soilmonitor.it}} is the combination of the data, visualization and logic tiers described in section \ref{sec:MatMet} and is currently in use and active within the Italian administrative boundaries (Figure \ref{fig:SMapp}).
%\subsection{Workflow of the integrated platform}

%\toberevised{[FROM section \ref{sec:validation}, Validation]}
%The Soil Monitor geospatial cyber-infrastructure implements via the web both data services (WMS and WFS, visualization tier in Figure \ref{fig:GCI}) to enhance data interoperability and processing services (WPS, logic tier in Figure \ref{fig:GCI}) to expose soil sealing metrics outside the web application.


\toberevised{[as results, show the GCI at work on two specific metrics, then describe the case studies ratio (i.e. they are a way to show SMapp at work)]}

\toberevised{ \ldots I might need a sentence to introduce the analysis provided in the 3 case studies, since we do not have a straight link with methods and directly start the case studies. Hence, one sentence to introduce the matter. }


\subsection{ Fragmentation and discontinuous urban fabric }
\toberevised{[FRAGMENTATION: decide how to fix the duplicated result here and in the provincial case study]}

A detailed explanation of how the calculation of the map of rural fragmentation is performed can be found in section \ref{sec:mmFragmentation}, while results are shown
 together with discussion
in the quantitative analysis provided at the province level (section \ref{sec:casePROV}) to avoid verbosity.

\toberevised{[DUF calc]}\\
Accordingly, an example of the pyramidal architecture based on the CUDA kernels is presented in Figure \ref{fig:ccl}, describing the calculation of the discontinuous urban fabric surface ($S_{DUF}$) using a connected component labelling algorithm specifically developed for Soil Monitor.

This calculation shows one of the most powerful implementations available in the infrastructure.
Indeed, ten CUDA kernels are used to uniquely label each urban patch and determine its consistency in terms of the number of adjacent pixels within each patch.

As shown in Figure \ldots we have very small elapsed time to complete the calculation for very big areas (e.g. 10000 x 18000 pixels)
\ldots $S_{DUF}$  is the final outcome depicted in figure \ref{fig:ccl} which is used to calculate two metrics included in Soil Monitor, that is the urban sprawl (Table \ref{tab:SMappToolbox}, ID=5) and the residual mean patch surface (Table \ref{tab:SMappToolbox}, ID=9).
The procedure till the sort of patch sizes, can be used to calculate the size $S_{max}$ of the largest urban patch, which is used to measure the largest class patch index (Table \ref{tab:SMappToolbox}, ID=8).

\begin{figure}[t] % FIGURE 03
    % \includegraphics[width,,height=15pc,draft]
    \centerline{\includegraphics[width=500pt]{daMileti/03_DUF_explanation.pdf}}
    \caption{ The calculation of the discontinuous urban fabric surface ($S_{DUF}$) developed within Soil Monitor cyberinfrastructure. 
    The pixel-based calculations are perfomed on the GPU card running a connected component labelling algorithm written in CUDA-C. 
    The patch-based calculations are performed on the CPU by Java code.
    The elapsed times in the box of CUDA kernels refer to an image of size $180 \times 10^6$ pixels using a NVIDIA TESLA C2075 GPU card.
    ( DUF = discontinuous urban fabric; CUF = continuous urban fabric; $S_{max}$ = largest urban patch)} \label{fig:ccl}
\end{figure}

%\subsection{Soil Monitor at work on three Italian case studies}\label{sec:caseStudies}
\subsection{Quantitative monitoring and analysis on three Italian case studies using Soil Monitor}\label{sec:caseStudies}

\subsubsection{ Land use/cover monitoring for whole Italy } \label{sec:caseIT}
% AIM
% The aim of this case study is to show how Soil Monitor contributes to assess land use/land cover changes in Italy and reveal trends in these changes using the interactive change matrix produced by the platform.
%This case study aims to show how to assess land use/cover changes using Soil Monitor.

% HOW LULC IS DETERMINED:
%The land use/cover pattern of a region is an outcome of natural and socio-economic factors and their utilization by man in time and space. Information on land use/cover and possibilities for their optimal use is essential for the selection, planning and implementation of land use schemes to meet the increasing demands for basic human needs and welfare. This information also assists in monitoring the dynamics of land use resulting out of changing demands of increasing population. Land use affects land cover and changes in land cover affect land use. Changes in land cover by land use do not necessarily imply degradation of the land. However, many shifting land use patterns driven by a variety of social causes, result in land cover changes that affects biodiversity, water and radiation budgets, trace gas emissions and other processes that come together to affect climate and biosphere (Riebsame et al., 1994). Land use/cover change detection is very essential for better understanding of landscape dynamic during a known period of time having sustainable management. Land use/cover changes is a widespread and accelerating process, mainly driven by natural phenomena and anthropogenic activities, which in turn drive changes that would impact natural ecosystem (Ruiz-Luna and Berlanga-Robles, 2003, Turner and Ruscher, 2004). Understanding landscape patterns, changes and interactions between human activities and natural phenomenon are essential for proper land management and decision improvement. Today, earth resource satellites data are very applicable and useful for land use/cover change detection studies (Yuan et al., 2005a, Yuan et al., 2005b, Brondizio et al., 1994).
%\toberevised{
Land use/cover pattern is the consequence of natural and socio-economic factors and their utilization by man in time and space.
Knowledge about land use/cover, for instance assisted by monitoring, and potentialities for optimal use are crucial for the selection, planning and implementation of land use schemes that meet both the increasing demands for basic human needs and %welfare.
%This information also assists in monitoring the dynamics of land use resulting out of 
the changing demands of increasing population.
%}
% WHY LULCC is important:
%Accurate monitoring of changes on the Earth's surface is important to understand the relationship between man and nature and to provide decision makers with relevant information. The information on vegetation change is the most important of these relationships. Vegetation cover is also a useful indicator of the magnitude of land degradation that is easily assessed by multispectral remote sensing.
%\toberevised{
Consequently, accurate monitoring of the temporal changes of the land surface state is important to understand the relationship between man and nature and to provide decision makers with relevant information.
The information on vegetation change is probably the most important of these relationships and will be used in the following analysis.
The type and evolution of vegetation cover can be a powerful indicator of the magnitude of land degradation that is assessed by comparing land use/cover maps over different times.
%}
% WHAT ARE LU and LC:
%Land use/cover is two separate terminologies which are often used interchangeably (Dimyati et al., 1996). Land cover refers to the physical characteristics of earths surface, captured in the distribution of vegetation, water, soil and other physical features of the land, including those created solely by human activities e.g., settlements. While land-use refers to the way in which land has been used by humans and their habitat, usually with accent on the functional role of land for economic activities. 
Although land cover reflects the physical characteristics of earth's surface and differently land use refers to the way in which land has been used by humans, it is not possible to keep them separated in the analysis.

% OLD BLOCK: MONITORING IN ITALY
%\update{[OLD BLOCK]}
In Italy, the monitoring of land take is accounted for by the National System for the Protection of the Environment (SNPA) as established by the entry into force of law 132/2016.
Accordingly, the SNPA is coordinated by ISPRA and involves all Italian Environmental Protection Agencies (ARPA-APPA) working at the regional level. 
This monitoring is scheduled in order to have an annually updated picture of the soil sealing evolution (e.g. ISPRA 2016, 2018) and the dynamics of land transformation and urban development, which is done through the production of thematic maps and the development of specific indicators. 
Law 132/2016 states that the SNPA must ensure such monitoring through monitoring points/networks or earth observation techniques (e.g. Copernicus).
In performing such monitoring, ISPRA and SNPA face two major problems: (i) difficult interaction with over 8000 Italian municipalities and (ii) the lack of awareness about the impact of the soil sealing on land degradation by citizens and other public authorities.

% COMMENTS ON NUMERICAL RESULTS IN ITALY:
%During the last 30 years the total livestock number increased from 4,709 thousand (1970) to 7,792 thousand (1996) and 17 million heads (2005), at the same time population increased more than 2.5 times. Consequently, the anthropogenic pressure on these areas has increased.
%The increase in the cultivated irrigation led to 1) increased demand in irrigation water and water for drainage; 2) further rise of ground water level; 3) secondary soil salinization processes.
%Changes in vegetation cover and its productivity in the temporal and spatial aspect is probably the most sensitive sign and early indicator to desertification processes; however, it is not an easy task to monitor vegetation state over large areas.

In this framework, Soil Monitor can indeed represent an important step forward in land use/cover quantitative monitoring and analysis.
% ---FROM NEW FABIO's ELABORATION-----------
%\update{[FROM FABIO]}
%RoI = Italy
%Dates = 50's vs 2012
To show the results in Figure \ref{fig:caseIT}, the calculation of the matrix of land use/cover change was submitted to the platform using the whole Italy as RoI and the two contrasting yeas 1954 and 2012 as time filters.
The system produced an interactive change matrix with the land use changes between 13 different classes for the entire country.
From these data (see Figure \ref{fig:caseIT}\textit{a} and \textit{b}) it is very interesting to emphasise that the land use class mostly affected by new \textit{artificial surfaces} is the \textit{complex cultivation patterns} with a loss of 418,604 ha, that is the 26.72\% of transformation into \textit{artificial surfaces} was possible due to the consumption of \textit{complex cultivation patterns} in whole Italy from 50's to 2012.
Since the matrix of changes generated by Soil Monitor is interactive, the click on the column of artificial surfaces produced either a pie chart (not shown) enabling an immediate and intuitive quantification of the changes by classes contributing to \textit{artificial surfaces} or an image map where it is possible to see where these changes have occurred (see the zoom of such a map in Figure \ref{fig:caseIT}\textit{c}).
%In this specific case it is possible to observe that t
It is possible to observe that the largest changes from \textit{complex cultivation patterns} to \textit{artificial surfaces} occurred at the fringes of earlier urban centres.
%Of course similarly to the above, any ROI can be freely selected by the user and any portion of the Italian territory can be analyzed. 

%{\setlength\intextsep{0pt}
\begin{figure}[t] % FIGURE 04
    % \includegraphics[width,,height=15pc,draft]
    \centerline{\includegraphics[width=450pt]{daMileti/04_caso_nazionale.pdf}}
    \caption{ The interactive change matrix calculation for whole Italy between 1954 and 2012.
    (a) The matrix of changes in hectares (ha) with particular focus on the column of \textit{artificial surfaces} (year 2012) with contributions coming from other classes.
    (b) Same matrix of change as in (a) but expressed in percentage of the overall Italian area (except in parenthesis where percentages refer to the total of the class in header).
    (c) \toberevised{\ldots put some text here!}
    The changes in both the chart and the map are depicted by colours, each of which is associated with the class in the reference year (1954) consumed by artificial surfaces in the current year (2012) } \label{fig:caseIT}
\end{figure}

\textit{Forests} covers one third (33.66\%) of the Italian area on 2012 and is one of the most conservative classes with respect to land take, since it only contributed by 4.41\% to the overall transformation into \textit{artificial surfaces} (the 0.23\% of total area).
%On the contrary the \textit{complex cultivation patterns} is the land use category mostly affected by new land take.
Considering the above evidences along with the analysis of other land use classes, as a concluding remark the classes characterised by a lower level of specialization are the most fragile with respect to new land take.
\textit{Complex cultivation patters} and \textit{non-irrigated arable land} have suffered a tremendous general trade off with different other classes, because only about a quarter and half of their surfaces remained unchanged between 1954 and 2012, respectively.
It quantifies the great impact of man pressure in solely 60 years, considering that \textit{complex cultivation patters} and \textit{non-irrigated arable land} together cover about the 42\% of the Italian territory.
On the contrary instead, classes such as \textit{vineyards}, \textit{olive groves} and \textit{fruit trees and berry plantations} are better defending, in particular against the land take aggression.
Therefore, higher specialization in agriculture would perhaps produce more resilient land use/cover classes to challenge new land take pressures.

By means of the Soil Monitor platform, we analysed the changes between 1954 and 2012 in further detail
%, not only limited to the entire national territory but also 
for each separate Italian administrative region, with particular emphasis on quantifying changes in \textit{artificial surfaces}, \textit{forests} and \textit{complex cultivation patterns} (see Figure \ref{fig:caseIT_graphs}a).
Those regions, such as Lombardia and Veneto, experiencing a large land take (about 10\% and 8\% of their regional areas, respectively) are also most affected by a loss in \textit{complex cultivation patterns}.
On the contrary, regions affected by weak land take dynamics, such as Molise, Valle D'Aosta and Liguria show a better preservation of the \textit{complex cultivation patterns} class.% \toberevised{[WHY THIS CLASS IS SO IMPORTANT, THAT WE HAVE TO PRESERVE?]}

\begin{figure}
    \centerline{ \includegraphics[width=450pt]{daMileti/05_caso_nazionale_grafici.pdf} }
    \caption{Breakdown of changes by region assuming the regional area as total within each region.
             (a) Impact of regional changes on \textit{artificial surfaces}, \textit{forests} and \textit{complex cultivation patterns}.
             (b) Regional changes in the trade off between \textit{forests} and \textit{complex cultivation patterns} with \textit{artificial surfaces}.}
    \label{fig:caseIT_graphs}
\end{figure}

A close-up of the above evidences is reported in Figure \ref{fig:caseIT_graphs}(b) where we quantified the impact of artificial surfaces over \textit{forest} and \textit{complex cultivation patterns}. 
%In this \toberevised{figure} it is evident that 
The areas covered by \textit{complex cultivation patterns} have been strongly challenged by land take in regions such as Veneto, Lombardia, Emilia Romagna and Friuli Venezia Giulia which have also the largest gross domestic production in Italy.
%Large \textit{complex cultivation patterns} losses by artificial surfaces can also be detected in Friuli and Marche\ldots we must say something otherwise delete.
% ---FROM NEW FABIO's ELABORATION-----------

%Anyhow, such analysis gives only quantitative assessments and shows the detailed and aggregated trends of changes. Then the user can attempt to qualify these changes, that is to provide an explanation about the causes and effects of changes.
%Anyhow, such analysis gives only quantitative assessments and shows the detailed and aggregated trends of changes.
%Then the user can attempt to qualify these changes, that is to provide an explanation about both the causes and the effects of changes.

%\subsubsection{The case study of territorial plan (PTCP)}
\subsubsection{The territorial plan at the province level (PTCP)} % \toberevised{(or metropolitan?)} 
\label{sec:casePROV}
In Italy, the reference administrative level for urban planning coordination in terms of environmental issues is the province law 142/1990. 
Thus, it is the key geographical level to challenge land take. 
However, this situation somehow remained unchanged after law 56/2014 (rules on metropolitan cities) and even after the constitutional referendum that transfers the competences of the provinces to the regions (4 December 2016).
Currently, provinces (albeit in specific cases, metropolitan cities and regions) carry out the fundamental coordinating role for territorial planning, protection, and enhancement. 
Moreover, typically, this is performed through the ''territorial plan of coordination at province level'' called PTCP (Piano Territoriale di Coordinamento Provinciale), which aims at: (i) land use regulation to protect natural areas and cultural heritage; (ii) guidance and implementation of subordinate planning producing general guidelines to be followed by municipalities in their local plans; (iii) coordination of planning activities by local authorities in order to achieve a rational organization of the provincial spaces.

In the last decades, there have been many regional laws and provincial policies in Italy, highlighting the need to mitigate land take, thus guaranteeing the preservation of the landscape and its ecosystem services. 
In such a framework, the crucial need to support the PTCP planning in order to truly mitigate soil sealing is evident. 
This government level is farther to the pressures of pro-growth policies, which are instead strongly grounded in the city and town leading coalitions.
Therefore, Soil Monitor can help implement these regulative ambitions.
For each Italian province, the platform allows carrying out a detailed analysis of both recent and past urbanization with the production of indices and maps identifying the main soil sealing criticalities within the territory.
Moreover, Soil Monitor classifies administrative units on the base of urban sprawl, giving the opportunity to the governing body to define targeted and selected geographies of the densification policy.

%A case of use of the platform at the provincial level is reported in Figure \ref{fig:casePROV}, which shows a plot of three indicators, namely LCDI, RMPS, and ED (presented in Table \ref{tab:IMPclasses}), describing the model of urban development of the five provincial capitals in Campania Region: Avellino, Benevento, Caserta, Napoli, and Salerno (Figure \ref{fig:casePROV}a). 
%The combination of the results of the three indicators helps in evaluating the degree of urban dispersion and, for instance, enables differentiating monocentric from polycentric municipalities. 
%As such, Caserta, Napoli, and Salerno --- having a LCPI larger than 70\% --- are monocentric and compacted, while Avellino and Benevento have a clearly polycentric distribution.

\begin{figure}[t] % FIGURE 05
    % \includegraphics[width,,height=15pc,draft]
    \centerline{\includegraphics[width=250pt]{daMileti/06_caso_provinciale.pdf}}
    \caption{ Soil Monitor supports the analysis at the level of the territorial plan of coordination (PTCP). } \label{fig:casePROV}
\end{figure}

In Figure \ref{fig:casePROV} a quantitative map of the rural fragmentation is given for the Milano province, an area very dynamic with a high per capita income and high residential and infrastructure pressure. 
This map is very important because it enables the quantification of each point in the landscape to the degree of its rural integrity. 
Accordingly, calculations are performed on-the-fly, enabling planners to freely decide the radius of their analysis (size of kernel to be processed).
Generally, a smaller radius (e.g. 100 m) is useful for detailed urban planning at the scale of a specific intervention, such as a new green corridor or a new development.
By contrast, a fragmentation analysis performed with a large radius (e.g. >500 m) produces an output affected by very large areas, either urban or natural. 
Thus, this analysis is useful to describe major geographical trends of rural integrity.
The output from the above analysis can be profitably used to better plan future urban development, thus avoiding new fragmentation of rural areas, especially those with high integrity, and to plan where to place new green infrastructures connecting rural areas with high rural integrity.

%\subsubsection{The case study of municipal plan (PUC)}
\subsubsection{ \toberevised{Planning at the municipal level (PUC)} }
\label{sec:caseCOM}
%\toberevised{[FROM PTCP | as reference for text development]
%A case of use of the platform at the provincial level is reported in Figure \ref{fig:casePROV}, which shows a plot of three indicators, namely LCDI, RMPS, and ED (presented in Table \ref{tab:IMPclasses}), describing the model of urban development of the five provincial capitals in Campania Region: Avellino, Benevento, Caserta, Napoli, and Salerno (Figure \ref{fig:casePROV}a). 
%The combination of the results of the three indicators helps in evaluating the degree of urban dispersion and, for instance, enables differentiating monocentric from polycentric municipalities. 
%As such, Caserta, Napoli, and Salerno --- having a LCPI larger than 70\% --- are monocentric and compacted, while Avellino and Benevento have a clearly polycentric distribution.
%}

%\toberevised{[FROM FABIO]}\\
The municipal urbanization plan (PUC) is a tool for the management of the Italian municipal territory, which consists of cartographic and technical documents along with regulations for the management of urban and territorial transformations within the municipality.
The PUC stems from the old well known General Regulatory Plan (PRG established by Italian law 1150/1942); it is produced by urban planners assisted by experts from other fields (e.g. environmental scientists, pedologists, geologists, and lawyers).
Although the PUC has no duration limitations, it is periodically reviewed and has a long series of requirements, such as: (i) the identification and discipline of land uses; (ii) the subdivision of the territory into zones with different and complementary uses; (iii) the protection and enhancement of natural, landscape, and historical-cultural heritage. 
Moreover, since the PUC is the planning document closer to operational urban activities, it is important for Soil Monitor to be used at the municipal scale, where it enables (i) to analyse of a set of indicators of urban sprawl and of urban development, (ii) to support municipalities in having geospatial information useful for fulfilling the PUC requirements.

In the following it is shown the value of Soil Monitor in two different domains: (i) in quantification and analysis of land take dynamics and (ii) in municipality planning support. 

The study of quantification and analysis of land take dynamics at municipality level is presented in Figure \ref{fig:caseCOM_urbDev}, where a set of indicators for all the municipalities of the province of Napoli are reported for the quantitative analysis.
The statistics on \textit{Largest Class Patch Index} (LCPI) , \textit{Residual Mean Patch Surface} (RMPS) and \textit{Edge Density} (ED) metrics highlight a very large variation between the municipalities (Figure \ref{fig:caseCOM_urbDev}a).
More specifically, Casavatore shows a strong monocentric urban development with the highest LCPI value (LCPI: 99.98), while Monte di Procida has the most pronounced
polycentric nature with many small urban nuclei (RMPS: 1.18).
An analysis on edge density --- which is a good proxy of urban dispersion (e.g. \citealp{SCHWARZ2010}) --- shows that rural mountain settlement of Agerola has the highest urban dispersion (ED: 1174) while the almost fully urbanized area of Casavatore shows the lowest urban dispersion trend (ED: 74).
Therefore, it is evident that these data requires further integration with other indexes such as \% urbanized area and population.
In Figure \ref{fig:caseCOM_urbDev}b we report a diagram quantifying ED for the municipalities of the province of Napoli.
There are over 22 municipalities with a very high (>600) edge density and many of them refer to summer-based touristic sites in hilly and mountain sites (Agerola, Serra Fontana, Annacapri, Massalubrense, Vico Equense, Barano dIschia, Capri, Forio, Piano di Sorrento, etc.).
While the municipalities with the lower edge density (Casavatore, Arzano, Cardito, Melito di Napoli Portici) are not rural sites but rather strongly urbanized cities with very minimal and concentrated rural areas (thus low ED metric).

\begin{figure}
    \centerline{
        \includegraphics[width=450pt]{daMileti/08_caso_comunale_tabella_grafici.pdf}
    }
    \caption{Caso comunale tabella e grafici}
    \label{fig:caseCOM_urbDev}
\end{figure}

A more detailed analysis was then performed on the ratio between edge density and population size to highlight municipalities having a strong urban dispersion despite low population (Figure \ref{fig:caseCOM_urbDev}c).
This analysis highlights that many small municipalities (e.g. Liveri, Comiziano, Carbonara di Nola,Casola di Napoli) --- well immerse in the rural environment and not having a touristic value --- show unexpected high ED/population values thus depicting a strong aggression of rural areas despite the very low population pressure.
From all analysis above it is evident the high explication value of the above indexes to better understand the urban development and, even more importantly, the impact of land take at municipality level.

In addition to the analysis of the land take dynamics given above, an analysis to support urban planning at the municipality level using Soil Monitor is provided in the following (Figure \ref{fig:caseCOM_Ercolano}).
The city of Ercolano is located between the Vesuvius volcano and the Tyrrhenian Sea, has a high population density, and is devoted to tourism owing to historical sites and spot of high-quality agriculture (e.g. wine, fruit trees, and flowers). 
Therefore, the user can get a quantification of the evolutive trajectories that led to specific land use and land cover states. 
In the example shown in Figure \ref{fig:caseCOM_Ercolano}(a, b), the amount and the geolocation of the consumption exerted by artificial surfaces is clear, above all, regarding vineyards, fruit trees, and olive orchards. 
This interpretation about the LULC evolution is accompanied by the recognition that part of the land take was very close (if not inside) to the protected areas (Figure 7c) of the Vesuvius's slopes, thereby confirming the very high pressure of urbanization not well managed by local authorities. 
Accordingly, the model of urban development was computed in the same municipality of Ercolano against other most populated cities in the Napoli province. 
Figure \ref{fig:caseCOM_Ercolano}(d) shows the population size and density (the left side of the table) and the indicators of model of urban development (LCPI, RMPS, and ED on the right side of the table), depicting the main urban trends in the Napoli province.
The results reported in Figure \ref{fig:caseCOM_Ercolano} are limited examples of the information that can possibly be achieved using Soil Monitor, which can be profitably used to enhance the definition and implementation of plans at the municipality scale (PUC in Italy).
This finding becomes much more important considering Soil Monitor is operational over the entire Italian territory with more than eight thousand municipalities.

\begin{figure}[t] % FIGURE 06
    % \includegraphics[width,,height=15pc,draft]
    \centerline{\includegraphics[width=450pt]{daMileti/07_caso_comunale.pdf}}
    \caption{ Soil Monitor supports the analysis at the level of the municipal urbanization plan (PUC). }
    \label{fig:caseCOM_Ercolano}
\end{figure}

\subsection{Final discussion}
%\subsubsection{ \toberevised{Case studies | remove paragraph title} }
%\toberevised{add blocks from the three case studies}
%Soil Monitor, by placing emphasis on landscapes, seeks to reduce the gap between policy and implementation being able to quantify and visualize (with the change in time of) the state of the land system.
%\update{[from the Introduction]}
Soil Monitor is designed to address the accountancy of soil sealing through different indicators providing operational support to urban planners, decision makers and multi stakeholders involved in landscape planning and interested in evaluating the impact of soil sealing. 
This specific contribution required a different approach, the result of which is the Soil Monitor geospatial cyberinfrastructure. 
A set of indicators can be calculated in real-time using either Italian administrative levels (NUTS2, NUTS3, and LAU2) or user-drawn Regions of Interest (RoI). 
Moreover, Soil Monitor uses high resolution layers produced every year by ISPRA (Italian Institute for Environmental Protection and Research) since 2015 for drawing up their yearly soil sealing report in Italy. 
Thus, owing to the high-performance computing embedded in its cyber infrastructure, Soil Monitor enables real-time geospatial processing while preserving a high spatial detail of the analysis over large areas (till LAU2); this combination of features has an intrinsic vast potential for being used in operational spatial planning as testified by the results presented in this work. 

%\subsubsection{ \toberevised{Weakness points | remove paragraph title | moved from CONCLUSIONS} }
Despite the huge endeavour spent on the logic tier to have GPU computing on board of Soil Sealing, the platform shows some important limitations caused by constraints in the data tier.
% first limitation due to data tier:
First, one main limitation is the lack of soil information underpinning the analysis in Soil Monitor, such as the lack of different qualities of soils and their spatial distribution in the scenario analysis.
To smoothly mitigate the fundamental shortcoming of not having soil information and to help discriminating between the different land qualities vulnerable to land take, SMapp shows (via WMS protocol) soil grids at 250m spatial resolution produced by ISRIC.
Attention should be drawn to the low accuracy of this grids with respect to the scale and detail of the land take analysis available in Soil Monitor.
%\toberevised{
% second limitation due to data tier:
Second, the base data (i.e. imperviousness layers by ISPRA) used in the analysis can have inconsistencies that Soil Monitor can highlight.
Indeed, it is possible to get artefacts in the results given by a misclassification of features over time with impervious covers unrealistically fluctuating over time or by a non-classification of imperviousness mostly in less urbanized or rural areas with evident underestimation of the land degradation process.\\
Soil Monitor provides basic \textit{what-if} modelling and scenario analysis building and it's authors belief that further effort should be performed to make the tools fully operational, mainly because of the need to provide real time answers.
%}

%\subsubsection{ \toberevised{Strength points | remove paragraph title} }
The JAVA/JCUDA/CUDA pipeline of Soil Monitor is described in section \ref{sec:logicTier}.
%It starts from MapStore that collects the user parameters, then GeoServer receive the parameters, prepare the inputs and recognize the exact set of processes to run. Subsequent to the Java layer (MapStore/Geoserver), the pipeline continues invoking the JCUDA layer in which the calculation of a metric is assembled.
It was shown that the JCUDA layer performs calls to the CUDA kernels compiled in PTX files to address the calculation of a soil sealing metric.
The proposed pipeline is an absolute technological novelty in the implementation of spatial decision support systems based on WebGIS and it enables the deploymeny of a fast geoprocessing engine capable to support a multi-user and multi-tasking web application.

To author knowledge, the
integration of high performance computing by means of the CUDA framework within web based geospatial cyberinfrastructures is absolutely new.
This is an important result that must be emphasized here not for the technological advancement itself, but because this technology is firstly applied to soil sealing and land degradation issues and because it changes the way in which different stakeholders (citizens, technicians, professionals, policy makers, etc.) can get informed about and measure soil sealing with agreed, certified and standard methods.

\subsubsection{ \toberevised{Design | remove paragraph title} }
The Soil Monitor spatial decision support system and visualization tools required to embody some crucial design items. 
Although the first version of the implementation was carried out without great involvement of stakeholders, because of money, time, and manpower constraints, at least two middle phases of consultation managed to apply modifications to the SMapp design and functionality. 
These consultations were performed with INU (National Institute for Urban planning) and ISPRA, which are the most important spatial planners' association in Italy along with being the public authority competent in monitoring land degradation and soil sealing, respectively.
Accordingly, after this discussion four major design considerations were included in Soil Monitor.
First, Soil Monitor uses national scale, standardized and high resolution soil imperviousness layers.
It avoids subjective soil sealing classification and very coarse soil sealing quantification as those using only the Corine Land Cover layers.
Second, Soil Monitor uses fully transparent processing engines in order to provide the user a complete understanding of the data output.
Third, Soil Monitor uses open-source approaches to be better tuned to FAIR (Findability, Accessibility, Interoperability, and Reusability) data.
Last but not least, Soil Monitor is capable to address high demanding computing needs encapsulating soil sealing models and indicators using a high performance computing approach.
Fast calculations allowed over the platform can speed up the decision-making process, such as a scenario analysis that, for instance, computes --- through the web and on-the-fly --- metrics related to the change of rural fragmentation after a new urban \toberevised{setting} is applied.
Furthermore, fast calculations were fundamental to manage both a multi-domain RoI definition and multi-user soil sealing platform.
Consequently, the choice was for a parallel computing platform based on graphics cards (GPU computing) using the NVIDIA hardware and software framework called CUDA (Compute Unified Device Architecture).
This required the implementation of stand-alone CUDA-C codes from scratch tailored to a GPU-based geospatial processing.
%Soil Monitor performs GPU computing thanks to the Java-JCuda-CUDA chain (described in section \ref{sec:logicTier}) which wraps the CUDA kernels, after compiling the CUDA-C source code in PTX executables.
The limitation of developing new code from scratch is overcome by high degree of code reusability, lower power consumption and higher computing scalability of GPU technologies with respect to standard CPU approaches.
%In addition, the high potential evolution of GPU technologies with respect to standard CPU approaches in the cloud too
%, including the continual increase in the availability of these resources over the cloud. 

%\subsubsection{\toberevised{From Validation | remove paragraph title}}
%Further, WPS can be easily adapted to enable the dynamic binding of geospatial processes to aid user needs, such as running a standardized algorithm on own or custom data.

%\subsubsection{ \toberevised{New points | remove paragraph title}}
% can people monitor and measure soil sealing or land take directly? Soil Monitor would give this opportunity to everyone interested\ldots

%\toberevised{[FROM caso studio NAZIONALE.]
%Furthermore, it is important to highlight that Soil Monitor contributes to the analysis of soil sealing through standardized approaches, thus avoiding the current trend of creating several customised indexes produced by many users as it currently happens in using the large flexibility offered by many kinds of desktop software (e.g. fragstat\footnote{https://www.umass.edu/landeco/research/fragstats/fragstats.html}). }


\section{Conclusions}
Soil sealing mitigation implemented through best practices in spatial land planning is a very virtuous goal, but \toberevised{it is also one of the greatest challenges of the modern world}. 
In fact, high quantity of information can only be accessed through satellite and drones, \toberevised{etc. concerning, for example, the agricultural, forestry, environmental, and spatial planning sectors is simply not sufficient to face the complexity of this challenge}.

\toberevised{This work shows that starting from the problem statement in a specific research domain, it is feasible to combine recent achievements in terms of data, models, indicators, WebGIS, and HPC technologies to produce an integrated geospatial cyberinfrastructure available on the web, aiming to account and mitigate the continual soil sealing phenomenon worldwide}. 
The proposed application called SMapp, which is freely accessible via an internet browser without the need to install any application or plugin on the local computer, aims to demonstrate that this approach is feasible, even though a more intuitive and easy to use dashboard is required.
Moreover, it takes advantage of the combination of updated high spatial resolution data on imperviousness available in Italy owing to ISPRA with tailored codes written in CUDA to gain embarrassingly parallel applications, thereby enabling a highly detailed analysis over large geographical extents.
Additionally, the combination of WebGIS with GPU computing running on-the-fly geospatial processing puts Soil Monitor at the fringe of research and development. 
Further, the GPU parallelism model enables a higher speedup than the CPU counterpart, at both a lower cost and a lower power consumption, with the main limitation being the requirement to design and \toberevised{write new codes from scratch (EXPLAIN BETTER, IT WAS NOT CLEAR TO REVIEWER)}. Finally, one key added value of the dedicated high performance library shown here is the opportunity to use the very basic imperviousness layers coming from Copernicus and ISPRA as inputs for quantitative analysis.

%\toberevised{
%\ldots only if we invest on detailed soil mapping at Country scale, we can monitor and contrast the soil sealing\\
%\ldots [!!!] we think that Country and also local administrative bodies should adopt such a technology to monitor and quantify to optimize planning procedures.\\
%}
Nevertheless, the proposed platform still remains a prototype from research that can be used for any area of the Italian territory. 
Subsequently, it can be seen as a democratic tool for creating reports that can catch the evolution of land use trajectories and connected land degradation interpretations about the ongoing of these land degradation processes.

%\toberevised{[DELETE::reviewer\#2, but try to reuse in discussion]}\\
%\reviewer{
%Despite the above positive statements, it is also essential to underline that the construction, maintenance, and updating of the infrastructure requires the following:
%\begin{enumerate}[label=(\roman*)]
%    \item Above all, a more comprehensive and detailed data on soils which, at least in Italy, are still missing to account for land degradation surface quantity. 
%    This information is critical to discriminate between the different land qualities vulnerable to land take. 
%    As such, we put soil grids by ISRIC via WMS to smoothly mitigate this fundamental shortcoming, considering the low accuracy of this grid with respect to the scale and detail of the land take accountancy.
%    \item A strong scientific effort to find the most suitable and reliable approaches for each application considering the available data.
%    \item A strong effort to integrate different types of knowledge and technology to develop and implement web applications, according to the use of open-source components such as GeoServer and MapStore.
%    \item Strong technical work to make the tools fully operational, mainly because of the need to provide real time answers (e.g. \textit{what-if} modelling and scenario analysis).
%    \item The need for the constant maintenance of data and applications in order to keep the platform constantly and consistently operational and not obsolete.
%    \item To reinforce the interoperability with data shared by other official providers. 
%    The more data and thematic layers available, the higher strength of deductions and interpretations performed during the analysis.
%    \item A more intuitive dashboard to simplify the user interaction with the visualization layer.
%    Indeed, because of the money constraints during the development, Soil Monitor does not ensure an easy and intuitive navigation during the job submission step. 
%    Nevertheless, we recognized the importance of a future effort to enhance fruition.
%\end{enumerate}
%}


\section*{ORCID}
Giuliano Langella \href{https://orcid.org/0000-0001-7210-0906}{ {\orcidicon{0000-0001-7210-0906}}\hspace{1.0mm} orcid.org/0000-0001-7210-0906}


\bibliography{SMapp}

%The normal commands for producing the reference list are:
%\begin{verbatim}
%\begin{thebibliography}{99}
%\bibitem{<x-ref label>}
%         <Reference details>
%\end{thebibliography}
%\end{verbatim}

\end{document}